# -*- coding: utf-8 -*-
"""streamlit_app.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1aIDDKw4kZhi8QBylEAK8wbB-VA3AOjyp
"""

import streamlit as st
import pandas as pd
import pickle

st.set_page_config(page_title='Adj Close Predictor')
st.title('KNN Regression â€” Adjusted Close')

@st.cache_resource
def load_model():
    with open('knn_pipeline.pkl', 'rb') as f:
        return pickle.load(f)

model = load_model()

c1, c2 = st.columns(2)
with c1:
    Open  = st.number_input('Open', 330.0, step=0.1)
    Low   = st.number_input('Low',  329.0, step=0.1)
with c2:
    High  = st.number_input('High', 333.0, step=0.1)
    Close = st.number_input('Close',331.5, step=0.1)

Volume = st.number_input('Volume', 2_000_000, step=1000)

if st.button('Predict'):
    X = pd.DataFrame([{
        'Open': Open, 'High': High, 'Low': Low, 'Close': Close, 'Volume': Volume
    }])
    pred = model.predict(X)[0]
    st.success(f'Predicted Adj Close: {pred:.2f}')